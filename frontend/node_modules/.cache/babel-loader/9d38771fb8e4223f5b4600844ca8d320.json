{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.setUpSocketIOPing = exports.appendQueryParams = exports.parseSocketIOUrl = void 0;\n\nvar constants_1 = require(\"./constants\");\n\nexports.parseSocketIOUrl = function (url) {\n  if (url) {\n    var isSecure = /^https|wss/.test(url);\n    var strippedProtocol = url.replace(/^(https?|wss?)(:\\/\\/)?/, '');\n    var removedFinalBackSlack = strippedProtocol.replace(/\\/$/, '');\n    var protocol = isSecure ? 'wss' : 'ws';\n    return protocol + \"://\" + removedFinalBackSlack + constants_1.SOCKET_IO_PATH;\n  } else if (url === '') {\n    var isSecure = /^https/.test(window.location.protocol);\n    var protocol = isSecure ? 'wss' : 'ws';\n    var port = window.location.port ? \":\" + window.location.port : '';\n    return protocol + \"://\" + window.location.hostname + port + constants_1.SOCKET_IO_PATH;\n  }\n\n  return url;\n};\n\nexports.appendQueryParams = function (url, params) {\n  if (params === void 0) {\n    params = {};\n  }\n\n  var hasParamsRegex = /\\?([\\w]+=[\\w]+)/;\n  var alreadyHasParams = hasParamsRegex.test(url);\n  var stringified = \"\" + Object.entries(params).reduce(function (next, _a) {\n    var key = _a[0],\n        value = _a[1];\n    return next + (key + \"=\" + value + \"&\");\n  }, '').slice(0, -1);\n  return \"\" + url + (alreadyHasParams ? '&' : '?') + stringified;\n};\n\nexports.setUpSocketIOPing = function (sendMessage, interval) {\n  if (interval === void 0) {\n    interval = constants_1.SOCKET_IO_PING_INTERVAL;\n  }\n\n  var ping = function () {\n    return sendMessage(constants_1.SOCKET_IO_PING_CODE);\n  };\n\n  return setInterval(ping, interval);\n};","map":{"version":3,"sources":["../../src/lib/socket-io.ts"],"names":[],"mappings":";;;;;;;AAAA,IAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AAGa,OAAA,CAAA,gBAAA,GAAmB,UAAC,GAAD,EAAY;AAC1C,MAAI,GAAJ,EAAS;AACP,QAAM,QAAQ,GAAG,aAAa,IAAb,CAAkB,GAAlB,CAAjB;AACA,QAAM,gBAAgB,GAAG,GAAG,CAAC,OAAJ,CAAY,wBAAZ,EAAsC,EAAtC,CAAzB;AACA,QAAM,qBAAqB,GAAG,gBAAgB,CAAC,OAAjB,CAAyB,KAAzB,EAAgC,EAAhC,CAA9B;AACA,QAAM,QAAQ,GAAG,QAAQ,GAAG,KAAH,GAAW,IAApC;AAEA,WAAU,QAAQ,GAAA,KAAR,GAAc,qBAAd,GAAsC,WAAA,CAAA,cAAhD;AACD,GAPD,MAOO,IAAI,GAAG,KAAK,EAAZ,EAAgB;AACrB,QAAM,QAAQ,GAAG,SAAS,IAAT,CAAc,MAAM,CAAC,QAAP,CAAgB,QAA9B,CAAjB;AACA,QAAM,QAAQ,GAAG,QAAQ,GAAG,KAAH,GAAW,IAApC;AACA,QAAM,IAAI,GAAG,MAAM,CAAC,QAAP,CAAgB,IAAhB,GAAuB,MAAI,MAAM,CAAC,QAAP,CAAgB,IAA3C,GAAoD,EAAjE;AAEA,WAAU,QAAQ,GAAA,KAAR,GAAc,MAAM,CAAC,QAAP,CAAgB,QAA9B,GAAyC,IAAzC,GAAgD,WAAA,CAAA,cAA1D;AACD;;AAED,SAAO,GAAP;AACD,CAjBY;;AAmBA,OAAA,CAAA,iBAAA,GAAoB,UAAC,GAAD,EAAc,MAAd,EAAsC;AAAxB,MAAA,MAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,MAAA,GAAA,EAAA;AAAwB;;AACrE,MAAM,cAAc,GAAG,iBAAvB;AACA,MAAM,gBAAgB,GAAG,cAAc,CAAC,IAAf,CAAoB,GAApB,CAAzB;AAEA,MAAM,WAAW,GAAG,KAAG,MAAM,CAAC,OAAP,CAAe,MAAf,EAAuB,MAAvB,CAA8B,UAAC,IAAD,EAAO,EAAP,EAAmB;QAAX,GAAG,GAAA,EAAA,CAAA,CAAA,C;QAAE,KAAK,GAAA,EAAA,CAAA,CAAA,C;AACrE,WAAO,IAAI,IAAM,GAAG,GAAA,GAAH,GAAO,KAAP,GAAY,GAAlB,CAAX;AACD,GAFsB,EAEpB,EAFoB,EAEhB,KAFgB,CAEV,CAFU,EAEP,CAAC,CAFM,CAAvB;AAIA,SAAO,KAAG,GAAH,IAAS,gBAAgB,GAAG,GAAH,GAAS,GAAlC,IAAwC,WAA/C;AACD,CATY;;AAWA,OAAA,CAAA,iBAAA,GAAoB,UAAC,WAAD,EAA2B,QAA3B,EAA6D;AAAlC,MAAA,QAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,QAAA,GAAW,WAAA,CAAA,uBAAX;AAAkC;;AAC5F,MAAM,IAAI,GAAG,YAAA;AAAM,WAAA,WAAW,CAAC,WAAA,CAAZ,mBAAW,CAAX;AAAgC,GAAnD;;AAEA,SAAO,WAAW,CAAC,IAAD,EAAO,QAAP,CAAlB;AACD,CAJY","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setUpSocketIOPing = exports.appendQueryParams = exports.parseSocketIOUrl = void 0;\nvar constants_1 = require(\"./constants\");\nexports.parseSocketIOUrl = function (url) {\n    if (url) {\n        var isSecure = /^https|wss/.test(url);\n        var strippedProtocol = url.replace(/^(https?|wss?)(:\\/\\/)?/, '');\n        var removedFinalBackSlack = strippedProtocol.replace(/\\/$/, '');\n        var protocol = isSecure ? 'wss' : 'ws';\n        return protocol + \"://\" + removedFinalBackSlack + constants_1.SOCKET_IO_PATH;\n    }\n    else if (url === '') {\n        var isSecure = /^https/.test(window.location.protocol);\n        var protocol = isSecure ? 'wss' : 'ws';\n        var port = window.location.port ? \":\" + window.location.port : '';\n        return protocol + \"://\" + window.location.hostname + port + constants_1.SOCKET_IO_PATH;\n    }\n    return url;\n};\nexports.appendQueryParams = function (url, params) {\n    if (params === void 0) { params = {}; }\n    var hasParamsRegex = /\\?([\\w]+=[\\w]+)/;\n    var alreadyHasParams = hasParamsRegex.test(url);\n    var stringified = \"\" + Object.entries(params).reduce(function (next, _a) {\n        var key = _a[0], value = _a[1];\n        return next + (key + \"=\" + value + \"&\");\n    }, '').slice(0, -1);\n    return \"\" + url + (alreadyHasParams ? '&' : '?') + stringified;\n};\nexports.setUpSocketIOPing = function (sendMessage, interval) {\n    if (interval === void 0) { interval = constants_1.SOCKET_IO_PING_INTERVAL; }\n    var ping = function () { return sendMessage(constants_1.SOCKET_IO_PING_CODE); };\n    return setInterval(ping, interval);\n};\n//# sourceMappingURL=socket-io.js.map"]},"metadata":{},"sourceType":"script"}